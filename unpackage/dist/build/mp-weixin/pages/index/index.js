(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{2685:function(e,n,t){"use strict";(function(e){t("c0b0");o(t("66fd"));var n=o(t("9ab7"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},"45f7":function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(t.bind(null,"cd5a"))},uniDataCheckbox:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox")]).then(t.bind(null,"231c"))},uniPopup:function(){return t.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(t.bind(null,"92c8"))},uniPopupMessage:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-popup/components/uni-popup-message/uni-popup-message")]).then(t.bind(null,"eef7"))}},r=function(){var e=this,n=e.$createElement;e._self._c},c=[]},"5dcd":function(e,n,t){"use strict";var o=t("6523"),r=t.n(o);r.a},6523:function(e,n,t){},6530:function(e,n,t){"use strict";t.r(n);var o=t("af7b"),r=t.n(o);for(var c in o)"default"!==c&&function(e){t.d(n,e,(function(){return o[e]}))}(c);n["default"]=r.a},"9ab7":function(e,n,t){"use strict";t.r(n);var o=t("45f7"),r=t("6530");for(var c in r)"default"!==c&&function(e){t.d(n,e,(function(){return r[e]}))}(c);t("5dcd");var i,a=t("f0c5"),u=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,"08a80db4",null,!1,o["a"],i);n["default"]=u.exports},af7b:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=c(t("a34a")),r=t("aab5");c(t("162e"));function c(e){return e&&e.__esModule?e:{default:e}}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){u(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n,t,o,r,c,i){try{var a=e[c](i),u=a.value}catch(s){return void t(s)}a.done?n(u):Promise.resolve(u).then(o,r)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var c=e.apply(n,t);function i(e){s(c,o,r,i,a,"next",e)}function a(e){s(c,o,r,i,a,"throw",e)}i(void 0)}))}}var f=function(){Promise.all([t.e("common/vendor"),t.e("components/lunarDate")]).then(function(){return resolve(t("655b"))}.bind(null,t)).catch(t.oe)},d=function(){Promise.all([t.e("common/vendor"),t.e("components/xLogin")]).then(function(){return resolve(t("f6ca"))}.bind(null,t)).catch(t.oe)},p={color:"#ccc",size:"20",type:"location"},m={components:{lunarDate:f,xLogin:d},data:function(){return{words:["路就在脚下，你无力改变终点，但却能决定脚踏出的方向","热情和欲望可以突破一切难关","忘记失败的痛苦，铭记失败的原因","要成功，不要与马赛跑，要骑在马上，马上成功","当一个人真正觉悟的一刻，他放下追寻外在世界的财富，而开始追寻他内心世界的真正财富"],radomIndex:0,types:[{text:"寄语墙",value:1},{text:"私密寄语",value:0}],hasLocaltion:!1,errMsg:"请输入寄语",RES_ROOT:r.RES_ROOT,form:{content:"",imgs:[],address:{},public:1}}},computed:{mapColor:function(){return this.hasLocaltion?"green":"#ccc"},mapIcon:function(){return this.hasLocaltion?"location-filled":"location"},actionIcon:function(){return this.hasLocaltion?"close":"forward"},mapAddress:function(){return this.hasLocaltion?this.form.address.name:"选择位置信息"}},onShow:function(){this.radomIndex=Math.round(4*Math.random())+0},onLoad:function(){var e=this;this.$nextTick((function(){e.resetForm()}))},methods:{resetForm:function(){this.form.content="",this.form.imgs=[],this.form.address={},this.form.public=1,this.hasLocaltion=!1},handleClearLocaltion:function(){this.hasLocaltion&&(this.hasLocaltion=!1,this.form.address={})},handleSubmit:function(){var n=this;return l(o.default.mark((function t(){var r,c,i;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a(a({},n.form),{},{address:JSON.stringify(n.form.address),imgs:n.form.imgs.join(",")}),""!==n.form.content){t.next=4;break}return n.$refs.popup.open(),t.abrupt("return");case 4:if(!(n.form.content.length>800)){t.next=8;break}return n.errMsg="寄语长度不能超过800字",n.$refs.popup.open(),t.abrupt("return");case 8:return t.next=10,n.$api.article.addArticle(r);case 10:c=t.sent,i=c.code,c.result,200===i&&(e.showToast({title:"创建成功",icon:"success",duration:1500}),n.resetForm(),e.switchTab({url:"/pages/article/index"}));case 14:case"end":return t.stop()}}),t)})))()},handleSelLocaltion:function(){var n=this;e.chooseLocation({success:function(e){n.form.address=Object.assign({},e),n.hasLocaltion=!0,p=Object.assign(p,{type:"location-filled",color:"green"}),console.log(e)}})},handleDel:function(e,n){this.form.imgs.splice(e,1),console.log(e,n)},preImg:function(n){var t=[];t[0]=n,e.previewImage({current:0,urls:t})},handleChooseImage:function(){var n=this;e.chooseImage({count:2,sourceType:["album","camera"],success:function(t){console.log("chooseImage success, temp path is",t.tempFilePaths[0]);var o=t.tempFilePaths[0];e.uploadFile({url:"".concat(r.BASE_URL,"/api/file/upload"),filePath:o,fileType:"image",formData:{prefix:n.$dayjs().format("YYYYMMDD")},name:"file",success:function(t){console.log("uploadImage success, res is:",t);var o=JSON.parse(t.data),r=o.code,c=o.result;200===r&&(e.showToast({title:"图片上传成功",duration:1e3}),n.form.imgs.push(c))},fail:function(n){console.log("uploadImage fail",n),e.showModal({content:n.errMsg,showCancel:!1})}})},fail:function(n){console.log("chooseImage fail",n),e.getSetting({success:function(n){var t=n.authSetting["scope.album"];t||e.showModal({title:"授权失败",content:"写寄语需要从您的相册获取图片，请在设置界面打开相关权限",success:function(n){n.confirm&&e.openSetting()}})}})}})}}};n.default=m}).call(this,t("543d")["default"])}},[["2685","common/runtime","common/vendor"]]]);